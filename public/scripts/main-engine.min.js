/*! -------------------------------------------------------------------------------------------
JAVASCRIPT main engine!

* @Version:    1.0 - 2017
* @author:     Burocratik
* @email:      hello@burocratik.com
* @website:    http://www.burocratik.com
* @preserve
NOTES:
:: js-no-ajax class on body (nao pode ser no html) > take it off with js as soon I work with ajax
:: js-no-ajax = did refresh
:: body.js-byrefresh= when i start by direct link (refresh) do no show content before loading
:: #loading-page.js-loading-page = i need separate byrefresh of this when I have js off
:: js-loading-page = can be used if I need a global style only when I am loading content
:: mobile = tag html is via js, tag body is via php (can't be on html tag or is deleted), also used for IE<=10
:: _global_allowNavigate = do not allow multiple cliks to load ajax (arrow, keys, click)
:: js-no-transPage = when I want a domain link with no transition ajax animation
--------------------------------------------------------------------------------------------*/
//END LOAD DOCUMENT
/********************************************************************************************
 **                                                                                       **
      =LOADING PAGES, SECTIONS - =transitions between pages, =ajax
 **                                                                                       **
*********************************************************************************************/
//** MAIN LOAD
function loadPages(newContent,pageTransition){var $currentPage=$(".page-main.page-current"),$nextContent=$(".page-main.page-next");// loading by ajax (removed onStartPage())
// can't be global
// I am using =ajax 
// loading by ajax (removed onStartPage())
return $("html,body").addClass("fixed-all"),$_body.removeClass("js-no-ajax"),$_body.addClass("js-loading-page"),"programs"==pageTransition?void $nextContent.load(newContent+" .page-toload",function(response,status,xhr){var $this=$(this);$this.find(".header-container").height();if(!$this.html())//=404
return window.location=newContent,!1;
// ANIMATION GOES HERE
TweenMax.fromTo($currentPage,0,{opacity:1},{opacity:0,onComplete:function(){manageBodyClasses(),clearPagesAfterloading(0),$("html,body").removeClass("fixed-all"),TweenMax.fromTo($nextContent,0,{opacity:0},{opacity:1,onComplete:function(){TweenMax.to($this.find(".header-photo-container .block-bg-cover"),2,{x:0,ease:Expo.easeInOut}),TweenMax.from($this.find(".header-container"),2,{height:0,delay:.2,ease:Expo.easeInOut}),TweenMax.to($this.find(".header-container .title, .header-container h4"),1,{y:0,delay:1.2,ease:Expo.easeOut}),TweenMax.to($this.find(".header-container .line"),1,{scaleX:1,delay:1.2,ease:Expo.easeOut}),TweenMax.from($this.find(".header-container .scroll-helper"),1,{y:300,delay:1.1,ease:Expo.easeInOut}),TweenMax.from($this.find(".call-to-action:not(.home-action)"),2,{y:300,delay:1.3,ease:Expo.easeOut}),TweenMax.staggerTo($this.find(".header-container ul li"),.4,{y:0,delay:1.8,ease:Power2.easeOut},.2),TweenMax.to("#programs-list-container",0,{className:"+=show",delay:1}),manageBodyClasses()}})}})}):"active-programs"==pageTransition?void $nextContent.load(newContent+" .page-toload",function(response,status,xhr){var $this=$(this);$this.find(".header-container").height();if(!$this.html())//=404
return window.location=newContent,!1;
// ANIMATION GOES HERE
TweenMax.fromTo($currentPage,0,{opacity:1},{opacity:0,onComplete:function(){manageBodyClasses(),clearPagesAfterloading(0),$("html,body").removeClass("fixed-all"),TweenMax.fromTo($nextContent,0,{opacity:0},{opacity:1,onComplete:function(){TweenMax.to($this.find(".header-photo-container .block-bg-cover"),2,{x:0,ease:Expo.easeInOut}),TweenMax.from($this.find(".header-container"),2,{height:0,delay:.2,ease:Expo.easeInOut}),TweenMax.to($this.find(".header-container .title, .header-container h4"),1,{y:0,delay:1.2,ease:Expo.easeOut}),TweenMax.to($this.find(".header-container .line"),1,{scaleX:1,delay:1.2,ease:Expo.easeOut}),TweenMax.from($this.find(".header-container .scroll-helper"),1,{y:300,delay:1.1,ease:Expo.easeInOut}),TweenMax.from($this.find(".call-to-action:not(.home-action)"),2,{y:300,delay:1.3,ease:Expo.easeOut}),TweenMax.staggerTo($this.find(".header-container ul li"),.4,{y:0,delay:1.8,ease:Power2.easeOut},.2),TweenMax.to("#back-btn",0,{className:"+=show",delay:1}),manageBodyClasses()}})}})}):void $nextContent.load(newContent+" .page-toload",function(response,status,xhr){var $this=$(this);$this.find(".header-container").height();if(!$this.html())//=404
return window.location=newContent,!1;
// ANIMATION GOES HERE
TweenMax.fromTo($currentPage,0,{opacity:1},{opacity:0,onComplete:function(){manageBodyClasses(),clearPagesAfterloading(0),$("html,body").removeClass("fixed-all"),TweenMax.fromTo($nextContent,0,{opacity:0},{opacity:1,onComplete:function(){TweenMax.to($this.find(".header-photo-container .block-bg-cover"),2,{x:0,ease:Expo.easeInOut}),TweenMax.from($this.find(".header-container"),2,{height:0,delay:.2,ease:Expo.easeInOut}),TweenMax.to($this.find(".header-container .title, .header-container h4, .header-container h3, .header-container p"),1,{y:0,delay:1.2,ease:Expo.easeOut}),TweenMax.to($this.find(".header-container .line"),1,{scaleX:1,delay:1.2,ease:Expo.easeOut}),TweenMax.from($this.find(".header-container .scroll-helper"),1,{y:300,delay:1.1,ease:Expo.easeInOut}),TweenMax.from($this.find(".call-to-action:not(.home-action)"),2,{y:300,delay:1.3,ease:Expo.easeOut}),TweenMax.from($this.find(".four04-btn"),2,{y:300,delay:1.3,ease:Expo.easeOut}),TweenMax.staggerTo($this.find(".header-container ul li"),.4,{y:0,delay:1.8,ease:Power2.easeOut},.2),
// if ($("#programs-list-container").hasClass("show")) {
//     TweenMax.to("#programs-list-container", 0, {className:"-=show"});
// }
// if ($("#back-btn").hasClass("show")) {
//     TweenMax.to("#back-btn", 0, {className:"-=show"});
// }
manageBodyClasses()}})}})})}function clearPagesAfterloading(delay){var $currentPage=$(".page-main.page-current"),$nextContent=$(".page-main.page-next");// can't be global
$.doTimeout(delay,function(){$currentPage.remove(),$nextContent.removeClass("page-next"),$nextContent.addClass("page-current").removeAttr("aria-hidden");var $newCurrentPage=$(".page-main.page-current");$newCurrentPage.after('<div class="page-main page-next" aria-hidden="true"></div>'),onStartPageWhenRefresh(!1),$newCurrentPage.attr("style",""),window.scrollTo(0,0),$("html,body").scrollTop(0)})}//end function
/********************************************************************************************
 **                                                                                       **
     =START EACH PAGE - refresh or ajax
 **                                                                                       **
*********************************************************************************************/
function onStartPageWhenRefresh(byRefresh){byRefresh?(
// :BUG CHROME: even wit this is not scrolling top is some section, needed hack after preloading with animate
window.scrollTo(0,0),$("html,body").scrollTop(0),
//
$("html,body").addClass("fixed-all"),$_loadingPage.addClass("js-loading-page"),$_body.removeClass("js-byrefresh"),$headerHeight=$(".header-container").height(),TweenMax.to(".header-photo-container .block-bg-cover",2,{x:0,ease:Expo.easeInOut}),TweenMax.from(".header-container",2,{height:0,delay:.2,ease:Expo.easeInOut}),TweenMax.to(".header-container .title, .header-container h4, .header-container h3, .header-container p",1,{y:0,delay:1.2,ease:Expo.easeOut}),TweenMax.to(".header-container .line",1,{scaleX:1,delay:1.2,ease:Expo.easeOut}),TweenMax.from(".header-container .scroll-helper",1,{y:300,delay:1.1,ease:Expo.easeInOut}),TweenMax.from(".call-to-action:not(.home-action)",2,{y:300,delay:1.3,ease:Expo.easeOut}),TweenMax.from(".four04-btn",2,{y:300,delay:1.3,ease:Expo.easeOut}),TweenMax.staggerTo(".header-container ul li",.4,{y:0,delay:1.8,ease:Power2.easeOut},.2),TweenMax.to("#back-btn",0,{className:"+=show",delay:1}),manageBodyClasses(),$_toPreload.imagesLoaded(function($images,$proper,$broken){$(this).imagesLoaded().always(function(){// :BUG CHROME: 100ms is arbitrary
// $_toPreload.remove(); because i need for section name
// if browser does not suport object-fit: cover
if($("html,body").animate({scrollTop:0},100),$_html.hasClass("no-object-fit")){var $element=$(".page-current .element-cover");resizeLikeCover($element)}
///
TweenMax.to($_loadingPage,.6,{opacity:0,ease:Power2.easeInOut,onComplete:function(){$("html,body").removeClass("fixed-all"),$_loadingPage.removeClass("js-loading-page").hide(),onStartPage()}}),$(".slider-pictures-wrapper").slick({dots:!0,adaptiveHeight:!0,autoplay:!0,swipeToSlide:!0})})})):onStartPage()}//////end function
/*-------------------------------------------------------------------------------------------
    =STARTPAGE - EACH PAGE - call of functions and events
--------------------------------------------------------------------------------------------*/
function onStartPage(){var do_home,do_archive_noticias,do_about,do_donation,do_programs,do_active_programs,do_media_center,do_single_media_center;
// ** =ALLOW user load other pages
_global_allowNavigate=!0,window.cancelAnimationFrame(_raf_loop_id),
// ** =REMOVE classes of loading (if needed)
$("html,body").removeClass("fixed-all"),$_body.removeClass("js-loading-page"),
// ** =HOME
do_home=!!$(".page-current .home-page").length,homePage(do_home),
// ** =ARCHIVE NOTICIAS
do_archive_noticias=!!$(".page-current .archive-noticias-page, .page-current .taxonomy-noticias-page").length,archiveNoticiasPage(do_archive_noticias),
// ** =SINGLE NOTICIAS
$(".page-current .single-noticias-page").length?do_single_noticias=!0:do_single_noticias=!1,singleNoticiasPage(do_single_noticias),
// ** =ABOUT
do_about=!!$(".page-current .about-page").length,aboutPage(do_about),
// ** =DONATION
do_donation=!!$(".page-current .donation-page").length,donationPage(do_donation),
// ** =PROGRAMS
do_programs=!!$(".page-current .programs-page, .page-current .single-programas-page").length,programsPage(do_programs),
// ** =ACTIVE PROGRAMS
do_active_programs=!!$(".page-current .active-programas-page").length,activeProgramsPage(do_active_programs),
// ** =MEDIA CENTER
do_media_center=!!$(".page-current .media-center-page").length,mediaCenterPage(do_media_center),do_single_media_center=!!$(".page-current .single-mediacenter-page").length,singleMediaCenterPage(do_single_media_center);
// ** =scrolling events
//whenScrolling(true);
// ** =URL com ancoras onload
var hasHash=window.location.hash;if(""!=hasHash){var $toGoHere=$(""+hasHash);$.doTimeout(500,function(){goTo($toGoHere,1500,[.7,0,.3,1],0)})}
// ** =RESIZE ELEMENTS LIKE BACKGROUND COVER (browser does not support object-fit: cover)
if($_html.hasClass("no-object-fit")){var $element=$(".page-current .element-cover");resizeLikeCover($element)}}//////end function StartPage
/*******************************************************************************************
 **                                                                                       **
    =MAIN =NAVIGATION and FORM NEWSLETTER
 **                                                                                       **
*********************************************************************************************/
function mainNavigation(){$(".news-form").on("submit",function(event){var $form=$(this);if(event.stopImmediatePropagation(),event.preventDefault(),event.stopPropagation(),0!==$form.find(".contact-email").val().length){var formResponse={pedido_contacto_email:$form.find(".contact-email").val()};$_window.width()>414?(TweenMax.to("footer .form .btn span.subscribe",.5,{y:"-47px",autoAlpha:0,onComplete:function(){TweenMax.set("footer .form .btn span.subscribe",{clearProps:"y"})}}),TweenMax.to("footer .form .btn span.loading",.5,{autoAlpha:1})):$("footer .form .btn").addClass("loading-state"),submitJSON("mailChimpSubscribe",formResponse,function(){$_window.width()>414?(TweenMax.to("footer .form .btn span.loading",.5,{y:"-47px",autoAlpha:0}),TweenMax.to("footer .form .btn span.success",.5,{autoAlpha:1,onComplete:function(){$.doTimeout(1e3,function(){$(".news-form")[0].reset()}),TweenMax.to("footer .form .btn span.success",.5,{y:"47px",autoAlpha:0,delay:1}),TweenMax.to("footer .form .btn span.subscribe",.5,{autoAlpha:1,delay:1,onComplete:function(){TweenMax.set("footer .form .btn span",{clearProps:"all"})}})}})):($("footer .form .btn").removeClass("loading-state"),$("footer .form .btn").addClass("success-state"),$.doTimeout(1500,function(){$(".news-form")[0].reset(),$("footer .form .btn").removeClass("success-state")}))},function(){$_window.width()>414?(TweenMax.to("footer .form .btn span.loading",.5,{y:"-47px",autoAlpha:0}),TweenMax.to("footer .form .btn span.error",.5,{autoAlpha:1,onComplete:function(){$.doTimeout(1e3,function(){$(".news-form")[0].reset()}),TweenMax.to("footer .form .btn span.success",.5,{y:"47px",autoAlpha:0,delay:1}),TweenMax.to("footer .form .btn span.subscribe",.5,{autoAlpha:1,delay:1,onComplete:function(){TweenMax.set("footer .form .btn span",{clearProps:"all"})}})}})):($("footer .form .btn").removeClass("loading-state"),$("footer .form .btn").addClass("error-state"),$.doTimeout(1500,function(){$(".news-form")[0].reset(),$("footer .form .btn").removeClass("error-state")}))})}})}//END LOAD DOCUMENT
/********************************************************************************************
 **                                                                                       **
     =FORMS AJAX SUBMITS
 **                                                                                       **
*********************************************************************************************/
function submitJSON(action,value,onSuccess,onError){$.ajax({data:{action:action,value:value},type:"post",dataType:"json",url:"http://"+_server_hostname+"/wp-admin/admin-ajax.php",success:function(data){onSuccess(data)},error:function(data){onError(data)}})}function submitForm($form){validateForm($form)&&!$form.hasClass("sending")&&($form.addClass("sending"),$.ajax({data:$form.serialize(),type:"post",dataType:"json",url:"http://"+_server_hostname+"/wp-admin/admin-ajax.php",success:function(data){$form.removeClass("sending")},error:function(data){$form.removeClass("sending")}}))}/*******************************************************************************************
 **                                                                                       **
    =GENERAL FUNCTIONS AND PLUGINGS CONTROL
 **                                                                                       **
*********************************************************************************************/
/** =Global page values */
function calculateGlobalValues(){_globalViewportW=verge.viewportW(),_globalViewportH=verge.viewportH(),_globalHalfViewportH=(_globalViewportH/2).toFixed(0)}/** =Random integer between min (included) and max (excluded) */
function getRandomInt(min,max){return Math.floor(Math.random()*(max-min))+min}/** =Manage for added body and page classes */
function manageBodyClasses(){$_body.hasClass("js-no-ajax")?$_body.addClass($(".page-main.page-current .page-toload").attr("data-bodyClass")):($_body.removeClass($(".page-main.page-current .page-toload").attr("data-bodyClass")),$_body.addClass($(".page-main.page-next .page-toload").attr("data-bodyClass")))}/* =ASYNC PLUGINS (polyfill, etc) */
function callAsyncFunctions(){window.respimage&&respimage()}/** 
 * @author       Rob W <gwnRob@gmail.com>
 * @website      http://stackoverflow.com/a/7513356/938089
 * @version      20131010
 * @description  Executes function on a framed YouTube video (see website link)
 *               For a full list of possible functions, see: 
 *               https://developers.google.com/youtube/js_api_reference
 * @param String frame_id The id of (the div containing) the frame
 * @param String func     Desired function to call, eg. "playVideo"
 *        (Function)      Function to call when the player is ready. 
 * @param Array  args     (optional) List of arguments to pass to function func*/
function callPlayer(frame_id,func,args){/* IE8 does not support addEventListener... */
function messageEvent(add,listener){var w3=add?window.addEventListener:window.removeEventListener;w3?w3("message",listener,!1):(add?window.attachEvent:window.detachEvent)("onmessage",listener)}console.log("callPlayer"),window.jQuery&&frame_id instanceof jQuery&&(frame_id=frame_id.get(0).id);var iframe=document.getElementById(frame_id);iframe&&"IFRAME"!=iframe.tagName.toUpperCase()&&(iframe=iframe.getElementsByTagName("iframe")[0]),
// When the player is not ready yet, add the event to a queue
// Each frame_id is associated with an own queue.
// Each queue has three possible states:
//  undefined = uninitialised / array = queue / 0 = ready
callPlayer.queue||(callPlayer.queue={});var queue=callPlayer.queue[frame_id],domReady="complete"==document.readyState;if(domReady&&!iframe)
// DOM is ready and iframe does not exist. Log a message 
window.console&&console.log("callPlayer: Frame not found; id="+frame_id),queue&&clearInterval(queue.poller);else if("listening"===func)
// Sending the "listener" message to the frame, to request status updates
iframe&&iframe.contentWindow&&(func='{"event":"listening","id":'+JSON.stringify(""+frame_id)+"}",iframe.contentWindow.postMessage(func,"*"));else if(domReady&&(!iframe||iframe.contentWindow&&(!queue||queue.ready))&&(queue&&queue.ready||"function"!=typeof func)){if(iframe&&iframe.contentWindow){
// When a function is supplied, just call it (like "onYouTubePlayerReady")
if(func.call)return func();
// Frame exists, send message
iframe.contentWindow.postMessage(JSON.stringify({event:"command",func:func,args:args||[],id:frame_id}),"*")}}else queue||(queue=callPlayer.queue[frame_id]=[]),queue.push([func,args]),"poller"in queue||(
// keep polling until the document and frame is ready
queue.poller=setInterval(function(){callPlayer(frame_id,"listening")},250),
// Add a global "message" event listener, to catch status updates:
messageEvent(1,function runOnceReady(e){if(!iframe){if(!(iframe=document.getElementById(frame_id)))return;if("IFRAME"!=iframe.tagName.toUpperCase()&&!(iframe=iframe.getElementsByTagName("iframe")[0]))return}if(e.source===iframe.contentWindow)
// .. and release the queue:
for(
// Assume that the player is ready if we receive a
// message from the iframe
clearInterval(queue.poller),queue.ready=!0,messageEvent(0,runOnceReady);tmp=queue.shift();)callPlayer(frame_id,tmp[0],tmp[1])}))}function openMenu(){var menuAnim=new TimelineMax,$nav=$("#nav-main"),$maskNavItem=$(".mask-nav-item"),$maskNavContact=$(".mask-nav-contact"),$logo=$(".logo-fill");$("html").css("overflow","hidden"),TweenMax.to("#header-main",1,{css:{position:"fixed"},delay:.3,ease:Linear.easeNone}),$("#programs-list-container").css("pointer-events","none"),menuAnim.to($nav,.8,{width:"100vw",force3D:!0,ease:Expo.easeInOut,onComplete:function(){bool=!0}}).staggerTo($maskNavItem,.8,{css:{transform:"translateY(0)"},ease:Power2.easeOut},.1,"-=0.3").to($maskNavContact,1,{css:{transform:"translateY(0)"},ease:Expo.easeOut},"-=1").to($logo,0,{fill:"#ffffff",ease:Linear.easeNone},"-=1.48").to($("#programs-list-container").find("ul"),.6,{height:0,ease:Power2.easeOut},"-=2").to($("#programs-list-container").find("ul li"),0,{className:"-=open"},"-=2").to("#programs-list-container, #back-btn",.3,{className:"-=show",ease:Power2.easeOut},"-=1.5").to("#btn-menu",0,{className:"+=color"},"-=1.25"),$("#programs-list-container").find(".arrow").hasClass("open")&&$("#programs-list-container").find(".arrow").toggleClass("open"),($("html").hasClass("ie")||$("html").hasClass("edge"))&&$("#nav-main").css("overflow-y","scroll"),$_body.hasClass("mobile")&&$("html, body").css({overflow:"hidden",position:"relative"}),window.viewportUnitsBuggyfill.refresh()}function closeMenu(){var menuAnim=new TimelineMax,$nav=$("#nav-main"),$maskNavItem=$(".mask-nav-item"),$maskNavContact=$(".mask-nav-contact"),$maskSubItem=$(".mask-sub-link"),$logo=$(".logo-fill");return $("html").css("overflow","auto"),$("#programs-list-container").css("pointer-events","all"),TweenMax.to("#header-main",1,{css:{position:"absolute"},delay:.8,ease:Linear.easeNone}),$("#sub-menu").hasClass("open")?($("#sub-menu").slideToggle(),$("#sub-menu").removeClass("open"),menuAnim.to($maskSubItem,1,{y:"100%",ease:Expo.easeOut}).to($maskNavContact,1,{y:"110%",ease:Expo.easeOut},"-=0.5").to($maskNavItem,1,{y:"100%",ease:Expo.easeOut},"-=1").to($nav,.8,{width:"0",force3D:!0,ease:Expo.easeInOut},"-=0.7").to($logo,0,{fill:"#232937",ease:Linear.easeNone,onComplete:function(){bool=!1}},"-=0.3").to("#programs-list-container, #back-btn",0,{className:"+=show"},"-=0.5").to("#btn-menu",0,{className:"-=color"},"-=1.6"),flagSub=!0):menuAnim.to($maskNavContact,1,{y:"110%",ease:Expo.easeOut},"+=0.5").to($maskNavItem,1,{y:"100%",ease:Expo.easeOut},"-=1").to($nav,.8,{width:"0",force3D:!0,ease:Expo.easeInOut},"-=0.7").to($logo,0,{fill:"#232937",ease:Linear.easeNone,onComplete:function(){bool=!1}},"-=0.3").to("#programs-list-container, #back-btn",0,{className:"+=show"},"-=0.5").to("#btn-menu",0,{className:"-=color"},"-=1.6"),$_body.hasClass("mobile")&&$("html, body").css({overflow:"auto",position:"inherit"}),flagSub}function globalStuff(){var $scrollHelper=$(".scroll-helper"),$lateralMenu=$(".menu-lateral-container"),$wrapper=$(".wrapper"),$relatedArticlesContainer=$(".related-articles-container"),mousewheelevt=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";$scrollHelper.css("opacity",2-$_window.scrollTop()/100),0==$_window.scrollTop()&&$wrapper.removeClass("active"),$(window).scrollTop()>_globalViewportH?$lateralMenu.addClass("pos-fixed"):$lateralMenu.removeClass("pos-fixed"),verge.inViewport($relatedArticlesContainer,0)&&$lateralMenu.removeClass("pos-fixed").addClass("new-pos"),$wrapper.each(function(){$this=$(this).attr("data-id"),$div=$("#"+$this),verge.inViewport($div,0)&&($wrapper.removeClass("active"),$(".wrapper[data-id="+$this+"]").addClass("active"))}),$(document).bind(mousewheelevt,function(e){var evt=window.event||e;evt=evt.originalEvent?evt.originalEvent:evt;var delta=evt.detail?evt.detail*-40:evt.wheelDelta,$relatedArticlesContainer=$(".related-articles-container"),$lateralMenu=$(".menu-lateral-container");delta>0&&!verge.inViewport($relatedArticlesContainer,0)&&$(window).scrollTop()>_globalViewportH&&$lateralMenu.removeClass("new-pos").addClass("pos-fixed")})}function hasScrolled(){var st=$(this).scrollTop();Math.abs(lastScrollTop-st)<=5||(st>lastScrollTop?(TweenMax.to(".menu-lateral-container",1,{css:{right:45}}),TweenMax.to("#programs-wrapper",1,{css:{top:-145},ease:Power2.easeOut})):st+$(window).height()<$(document).height()&&(TweenMax.to(".menu-lateral-container",4,{css:{right:-500},ease:Power2.easeOut}),TweenMax.to("#programs-wrapper",.3,{css:{top:btnTop},ease:Power2.easeOut}),0==$_window.scrollTop()&&TweenMax.to("#programs-wrapper",.3,{css:{top:btnTop},ease:Power2.easeOut})),lastScrollTop=st)}/** *******************************************************************************************
		 =ABOUT
*********************************************************************************************/
function aboutPage(do_about){/*page functions*/
/*Animation Loop*/
function aboutPage_scroll(){_raf_scroll_id=_rAF_loop(aboutPage_scroll_rAF)}function aboutPage_scroll_rAF(){var $maskN=$(".mask-number"),$pictoP=$("#picto-programs");globalStuff(),didScroll=!$_body.hasClass("mobile"),verge.inViewport($pictoP,-350)&&TweenMax.staggerTo($(".programs-pictos"),1,{className:"+=show"},.2),$maskN.each(function(){$div=$(this),verge.inViewport($div,-150)&&(TweenMax.to($(this).find("span"),2,{y:0,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".title"),2,{y:0,opacity:1,delay:.1,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".text"),2,{y:0,opacity:1,delay:.3,ease:Expo.easeOut}))})}if(!do_about)return $_window.off("scroll.aboutPage"),!1;$_window.on("scroll.aboutPage",aboutPage_scroll);/*variables*/
var $picto=$(".programs-pictos"),$btn=$picto.parent().find(".btn");/*events*/
TweenMax.set($btn,{y:10}),$(".wrapper").click(function(){var id=$(this).attr("data-id");TweenMax.to(window,1,{scrollTo:"#"+id,ease:Circ.easeInOut}),$(".wrapper").removeClass("active"),$(".wrapper[data-id="+id+"]").addClass("active")}),$picto.parent().on("mouseenter",function(){TweenMax.to($(this).find(".btn"),.2,{autoAlpha:1,pointerEvents:"auto",y:0})}),$picto.parent().on("mouseleave",function(){TweenMax.to($(this).find(".btn"),.2,{autoAlpha:0,pointerEvents:"none",y:10})}),$.each($(".picto-holder"),function(){var $this=$(this);if("performing-arts"==$this.attr("id"))var file="artes.json";else if("social-responsibility"==$this.attr("id"))var file="social.json";else if("marine-conservation"==$this.attr("id"))var file="marine.json";else if("wildlife-conservation"==$this.attr("id"))var file="wildlife.json";else if("medical-education-and-research"==$this.attr("id"))var file="medical.json";else if("aeronautical-education-and-research"==$this.attr("id"))var file="aero.json";var holder=$this.attr("id"),lineParams={container:document.getElementById(holder),renderer:"svg",loop:!0,autoplay:!0,path:"/public/pictos/bodymovin/"+file};lineMorph=bodymovin.loadAnimation(lineParams),lineMorph.play()}),
// var lineParams = {
//        container: document.getElementById('picto'),
//        renderer: 'svg',
//        loop: true,
//        autoplay: true,
//        path: '/public/pictos/bodymovin/' + file
//    };
//    lineMorph = bodymovin.loadAnimation(lineParams);
//
lineMorph.play()}//////end function about
/** *******************************************************************************************
		 =ACTIVE PROGRAMS
*********************************************************************************************/
function activeProgramsPage(do_active_programs){/*Animation Loop*/
function activePrograms_Page_scroll(){_raf_scroll_id=_rAF_loop(activeProgramsPage_scroll_rAF)}function activeProgramsPage_scroll_rAF(){$(".scroll-helper").css("opacity",2-$_window.scrollTop()/100),didScroll=!$_body.hasClass("mobile")}if(!do_active_programs)return $_window.off("scroll.activeProgramsPage"),!1;/*variables*/
/*events*/
if($_window.on("scroll.activeProgramsPage",activePrograms_Page_scroll),$(".back-link").attr("href",$(".page-toload").attr("data-parent")),$(".page-toload").hasClass("performing-arts"))var file="artes.json";else if($(".page-toload").hasClass("social-responsability"))var file="social.json";else if($(".page-toload").hasClass("marine-conservation"))var file="marine.json";else if($(".page-toload").hasClass("wildlife-conservation"))var file="wildlife.json";else if($(".page-toload").hasClass("medical-education-and-research"))var file="medical.json";else if($(".page-toload").hasClass("aeronautical-education-and-research"))var file="aero.json";var lineParams={container:document.getElementById("picto"),renderer:"svg",loop:!0,autoplay:!0,path:"/public/pictos/bodymovin/"+file};lineMorph=bodymovin.loadAnimation(lineParams),lineMorph.play();/*page functions*/
var numberSlides=$(".slide-active").length,$btnRight=$(".slider-arrow.right"),$btnLeft=$(".slider-arrow.left"),$activeSlide=$(".slide-active.active").attr("data-id"),carouselActive=new TimelineMax,moveOn=!0;$.each($(".slide-active"),function(){var id=$(this).attr("data-id");$("#bullets-active-carousel").append('<button class="bullet" data-id="'+id+'"></button>')}),$("#bullets-active-carousel").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),$trigger=function(){return right=function(){$slideActive=$(".slide-active.active"),$slideNext=$(".slide-active.next"),$activeSlide=$slideNext.attr("data-id"),carouselActive.to($slideActive,1,{css:{left:"100%"},ease:Expo.easeInOut,force3D:!0,onComplete:function(){$slideNext.removeClass("next").addClass("active"),$slideNext.next(".slide-active").addClass("next"),$slideActive.removeClass("active").css("left","0"),$slideNext.next().is(".slide-active")?$slideNext.next(".slide-active").addClass("next"):$(".slide-active").first().addClass("next"),$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$("#bullets-active-carousel").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),moveOn=!0}})},left=function(){$slideActive=$(".slide-active.active"),$slideNext=$(".slide-active.next"),$activeSlide=$slideActive.attr("data-id"),numberSlides>2&&$slideNext.css("display","none"),carouselActive.to($slideActive,1,{css:{left:"-100%"},ease:Expo.easeInOut,force3D:!0,onComplete:function(){$slideNext.removeClass("next"),$slideActive.removeClass("active").addClass("next").css("left","0"),$(".slide-active").css("display","block"),$slideActive.prev().is(".slide-active")?$slideActive.prev(".slide-active").addClass("active"):$(".slide-active").last().addClass("active"),numberSlides>2?0==$activeSlide?$activeSlide=2:$activeSlide-=1:0==$activeSlide?$activeSlide=1:$activeSlide-=1,$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$("#bullets-active-carousel").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),moveOn=!0}})},{right:right,left:left}}(),$(".bullet").on("click",function(){$(".bullet").css("pointer-events","none");var idClick=$(this).attr("data-id"),num=parseInt(idClick),total=num+1,idActive=$(".slide-active.active").attr("data-id");$activeSlide=$(".slide-active.next").attr("data-id"),idClick>idActive?($(".slide-active").removeClass("active").removeClass("next"),$(".slide-active[data-id="+idClick+"]").addClass("active"),total==numberSlides?$(".slide-active").first().addClass("next"):$(".slide-active[data-id="+idClick+"]").next(".slide-active").addClass("next"),$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$(".bullet").css("pointer-events","auto"),$("#bullets-active-carousel").find(".bullet[data-id="+num+"]").addClass("selected").css("pointer-events","none")):($(".slide-active").removeClass("active").removeClass("next"),$(".slide-active[data-id="+idClick+"]").addClass("active"),total==numberSlides?$(".slide-active").last().addClass("next"):$(".slide-active[data-id="+idClick+"]").next(".slide-active").addClass("next"),$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$(".bullet").css("pointer-events","auto"),$("#bullets-active-carousel").find(".bullet[data-id="+num+"]").addClass("selected").css("pointer-events","none"))}),$btnRight.on("click",function(){moveOn&&($trigger.right(),moveOn=!1)}),$btnLeft.on("click",function(){moveOn&&($trigger.left(),moveOn=!1)}),$.doTimeout(1e3,function(){$(function(){
// Find all YouTube videos 
var $allVideos=$("iframe"),
// The element that is fluid width
$fluidEl=$(".active-text");
// Figure out and save aspect ratio for each video
$allVideos.each(function(){$(this).data("aspectRatio",this.height/this.width).removeAttr("height").removeAttr("width")}),
// When the window is resized
// (You'll probably want to debounce this)
$(window).resize(function(){var newWidth=$fluidEl.width();
// Resize all videos according to their own aspect ratio
$allVideos.each(function(){var $el=$(this);$el.width(newWidth).height(newWidth*$el.data("aspectRatio"))})}).resize()})})}//////end function activePrograms
/** *******************************************************************************************
		 =ARCHIVE NOTICIAS
*********************************************************************************************/
function archiveNoticiasPage(do_archive_noticias){/*page functions*/
/*Animation Loop*/
function archiveNoticias_Page_scroll(){_raf_scroll_id=_rAF_loop(archiveNoticiasPage_scroll_rAF)}function archiveNoticiasPage_scroll_rAF(){$(".scroll-helper").css("opacity",2-$_window.scrollTop()/100),didScroll=!$_body.hasClass("mobile")}if(!do_archive_noticias)return $_window.off("scroll.archiveNoticiasPage"),!1;$_window.on("scroll.archiveNoticiasPage",archiveNoticias_Page_scroll);/*variables*/
var $anchor=$(".anchor"),$loadMore=$(".section-container").find("button");/*events*/
$anchor.click(function(e){e.preventDefault();var href=$(this).attr("href");TweenMax.to(window,1,{scrollTo:href,ease:Circ.easeInOut})});var realOffset=4,total=0;$loadMore.on("click",function(){var $this=$(this),term=$this.attr("data-term");$.get("/wp-json/mirpuri/v1/get-posts?term="+term+"&offset="+realOffset,function(data){$.each(data,function(key,value){if(total=value.total,key%2==0)var element_class="xxlarge-offset-2";else var element_class="";
// console.log(value);
// console.log(realOffset);		 		
$this.closest("article").find(".news-wrapper").last().after('<div class="xxlarge-6 '+element_class+' medium-14 medium-offset-1 xsmall-16 xsmall-offset-0 news-wrapper"><a href="'+value.url+'"><div class="news-photo"><div class="block-bg-cover"><picture><source srcset="'+value.thumb_url+" 1x, "+value.thumb_retina_url+' 2x"><img class="element-cover" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt=""></picture></div></div></a><a href="'+value.url+'"><div class="news-info"><h3>'+value.term[0].name+"<span> — "+value.date+'</span></h3><h2 class="title">'+value.post_title+'</h2><p class="text">'+value.content+"...</p></div></a></div>")}),realOffset+=4,total<=$this.closest(".row").find(".news-wrapper").length&&$this.hide()})})}//////end function archiveNoticias
/** *******************************************************************************************
		 =DONATION
*********************************************************************************************/
function donationPage(do_donation){/*page functions*/
/*Animation Loop*/
function donationPage_scroll(){_raf_scroll_id=_rAF_loop(donationPage_scroll_rAF)}function donationPage_scroll_rAF(){var $scrollHelper=$(".scroll-helper"),$maskN=$(".mask-number");$scrollHelper.css("opacity",2-$_window.scrollTop()/100),didScroll=!$_body.hasClass("mobile"),$maskN.each(function(){$div=$(this),verge.inViewport($div,-150)&&(TweenMax.to($(this).closest("article").find(".title"),2,{y:0,opacity:1,delay:.1,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".text"),2,{y:0,opacity:1,delay:.3,ease:Expo.easeOut}))})}if(!do_donation)return $_window.off("scroll.donationPage"),!1;$_window.on("scroll.donationPage",donationPage_scroll);/*variables*/
var $donationBtn=($(".form-input"),$(".donation-value"));/*events*/
$donationBtn.click(function(){$donationBtn.removeClass("selected"),$(this).addClass("selected")}),$(".donation-form").on("submit",function(event){var $form=$(this);if(event.stopImmediatePropagation(),event.preventDefault(),event.stopPropagation(),validateForm($form)&&!$form.hasClass("sending")){$form.addClass("sending");submitJSON("saveDonationForm",{donation_first_name:$form.find("#first-name").val(),donation_last_name:$form.find("#last-name").val(),donation_address:$form.find("#address").val(),donation_city:$form.find("#city").val(),donation_state:$form.find("#state").val(),donation_zip:$form.find("#zip").val(),donation_country:$form.find("#country").val(),donation_email:$form.find("#email").val(),donation_value:$form.find(".donation-value.selected button").text(),mirpuri_nonce:$form.find("#mirpuri_nonce").val()},function(data){
// console.log("success", data);
$form.find(".btn").text("Donation sent!")},function(){
// console.log("error", data);
$form.find(".btn").text("Please try again.")})}})}//////end function about
/** *******************************************************************************************
		 =HOME
*********************************************************************************************/
function homePage(do_home){function slideNext(){var moveSlide=new TimelineLite;
// if (bool) {
$(".bullet").css("pointer-events","none"),$bigSlideActive=$(".big-slide-container.active"),$bigSlideNext=$(".big-slide-container.next"),$smallSlideNext=$(".small-slide-container.next"),$mainTitle=$(".small-slide-container.next").attr("data-title"),$text=$(".big-slide-container.next").attr("data-text"),$subject=$(".big-slide-container.next").attr("data-subject"),$subjectUrl=$(".big-slide-container.next").attr("data-subjecturl"),$subjectAjaxUrl=$(".big-slide-container.next").attr("data-subjectajaxurl"),$(".small-slide-container").last().hasClass("next")?$title=$(".small-slide-container").first().attr("data-title"):$title=$(".small-slide-container.next").next().attr("data-title"),$ajaxUrl=$(".small-slide-container.next").attr("data-ajaxUrl"),$url=$(".small-slide-container.next").attr("data-url"),$type=$(".small-slide-container.next").attr("data-type"),changeTitle($title),changeInfo($mainTitle,$text,$subject,$ajaxUrl,$url,$type,$subjectAjaxUrl,$subjectUrl),$prev=$smallSlideNext.prev(".small-slide-container"),$next=$smallSlideNext.next(".small-slide-container"),moveSlide.to($bigSlideNext,2,{css:{right:0},ease:Expo.easeInOut}).to($next,0,{css:{display:"block"}},"-=1").to($prev,0,{css:{display:"none"}},"-=1").to($smallSlideNext,2,{css:{right:"-100vw"},ease:Expo.easeInOut,onComplete:function(){$bigSlideNext.next().is(".big-slide-container")?$bigSlideNext.next(".big-slide-container").addClass("next"):$(".big-slide-container").first().addClass("next"),$bigSlideNext.removeClass("next").addClass("active"),$bigSlideActive.removeClass("active").css("right","100vw"),$smallSlideNext.next().is(".small-slide-container")?($smallSlideNext.next(".small-slide-container").addClass("next"),$prev.css("display","none")):$(".small-slide-container").first().addClass("next"),$smallSlideNext.last().is(".small-slide-container")&&($(".small-slide-container").first().css("display","block"),$prev.css("display","none")),$(".small-slide-container").first().hasClass("next")&&$(".small-slide-container").last().css("display","none"),$smallSlideNext.removeClass("next").css("right","0"),$activeSlide=$(".big-slide-container.active").attr("data-id"),$("#bullets-container").find(".bullet").removeClass("selected"),$("#bullets-container").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),$(".bullet:not(.selected)").css("pointer-events","auto")}},"-=2")}function changeTitle($title){var titleAnim=new TimelineLite;return titleAnim.to($nextTitle,1,{y:"100%",ease:Expo.easeInOut,onComplete:function(){$nextTitle.html($title)}}).to($nextTitle,1,{y:"-0.1%",ease:Expo.easeInOut},"+=0.2"),titleAnim}function changeInfo($mainTitle,$text,$subject,$ajaxUrl,$url,$type,$subjectAjaxUrl,$subjectUrl){var infoAnim=new TimelineLite;return infoAnim.to($maskObjects,1,{y:"200%",ease:Expo.easeInOut,onComplete:function(){$("#main-title").html($mainTitle),$("#highlight-text").html($text),$("#subject").html($subject),$("#subject").parent("a").attr("data-ajaxUrl",$subjectAjaxUrl),$("#subject").parent("a").attr("href",$subjectUrl),$("#subject").parent("a").attr("data-title",$subject),$("#main-title").parent("a").attr("href",$url),$("#main-title").parent("a").attr("data-title",$mainTitle),$("#main-title").parent("a").attr("data-ajaxUrl",$ajaxUrl),console.log($("#main-title").closest(".mask").next(".mask").find("a")),$("#main-title").closest(".mask").next(".mask").find("a").attr("href",$url);var elHeight=$(".highlights-wrapper .columns").height();TweenMax.to($(".highlights-wrapper"),.5,{height:elHeight})}}),infoAnim.to($maskObjects,1,{y:"-0.1%",ease:Expo.easeInOut},"+=0.2"),infoAnim}/*Animation Loop*/
function homePage_scroll(){_raf_scroll_id=_rAF_loop(homePage_scroll_rAF)}function homePage_scroll_rAF(){var $maskN=$(".mask-number"),$progW=$(".programs-container");globalStuff(),didScroll=!$_body.hasClass("mobile"),verge.inViewport($progW,-50)&&TweenMax.staggerTo($(".program-wrapper"),1,{className:"+=show"},.2),$maskN.each(function(){$div=$(this),verge.inViewport($div,-150)&&(TweenMax.to($(this).find("span"),2,{y:0,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".title"),2,{y:0,opacity:1,delay:.1,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".text"),2,{y:0,opacity:1,delay:.3,ease:Expo.easeOut}))})}if(!do_home)return $_window.off("scroll.homePage"),!1;$_window.on("scroll.homePage",homePage_scroll);/*variables*/
var $progressBar=$("#progress-bar"),$nextTitle=$("#next-title-slide h2"),$maskObjects=$(".object"),bool=!1,growLineSequence=($(".program-info h3").outerHeight(),/*page functions*/
function(type){var lineAnim=new TimelineLite;return lineAnim.to($progressBar,5,{x:0,ease:Linear.easeNone,force3D:!0,onComplete:function(){lineAnim.to($progressBar,1,{x:"-100%",ease:Expo.easeIn})}}),lineAnim}()),
// slideSequence = slideNext(),
$activeSlide=$(".big-slide-container.active").attr("data-id");$(".highlights-wrapper");/*events*/
$(".wrapper").click(function(){var id=$(this).attr("data-id");TweenMax.to(window,1,{scrollTo:"#"+id,ease:Circ.easeInOut}),$(".wrapper").removeClass("active"),$(".wrapper[data-id="+id+"]").addClass("active")}),$(".highlights-wrapper").css("height",$(".highlights-wrapper").height()),$.doTimeout("timer",6e3,function(){return 1==(bool=!0)&&(growLineSequence.restart(),slideNext(),!0)});
// $.doTimeout('scrollStuff', 250, function(){
// 	flag = true;
// 	if (didScroll && flag == true) {
// 	    hasScrolled();
// 	    didScroll = false;
// 	    return true;
// 	}
// 	return false;
// });
$(".big-slide-container").length;$.each($(".big-slide-container"),function(){var id=$(this).attr("data-id");$("#bullets-container").append('<button class="bullet" data-id="'+id+'"></button>')}),$("#bullets-container").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),$(".bullet").on("click",function(){$(".bullet").css("pointer-events","none");var id=$(this).attr("data-id");id!=$(".small-slide-container.next").attr("data-id")?($(".small-slide-container.next").removeClass("next").addClass("prev").css("z-index","99"),$(".small-slide-container[data-id="+id+"]").addClass("next").css("display","block"),$(".small-slide-container[data-id="+id+"]").next(".small-slide-container").css("display","block"),TweenMax.to($(".small-slide-container.prev"),.3,{left:"-100vw",ease:Expo.easeInOut,onComplete:function(){$(".small-slide-container").removeAttr("style"),$(".small-slide-container.prev").removeClass("prev")}}),$.doTimeout(500,function(){$(".big-slide-container.next").removeClass("next"),$(".big-slide-container[data-id="+id+"]").addClass("next"),$.doTimeout("timer",!0)})):$.doTimeout("timer",!0)});var $elem=$(".program-info h3"),$trans=0;$_body.hasClass("mobile")||$elem.each(function(){var $this=$(this),$h=$this.height();44==$h&&TweenMax.to($this,.4,{css:{marginBottom:-66},ease:Expo.easeOut}),66==$h&&TweenMax.to($this,.4,{css:{marginBottom:-88},ease:Expo.easeOut}),88==$h&&TweenMax.to($this,.4,{css:{marginBottom:-110},ease:Expo.easeOut}),110==$h&&TweenMax.to($this,.4,{css:{marginBottom:-137},ease:Expo.easeOut}),132==$h&&TweenMax.to($this,.4,{css:{marginBottom:-158},ease:Expo.easeOut}),154==$h&&TweenMax.to($this,.4,{css:{marginBottom:-178},ease:Expo.easeOut}),$_body.hasClass("mobile")&&TweenMax.to($this,.4,{css:{marginBottom:0},ease:Expo.easeOut})}),$_body.hasClass("mobile")||$(".program-wrapper").hover(function(){$trans=$(this).find(".program-info h3").css("margin-bottom"),TweenMax.to($(this).find(".program-info h3"),.4,{css:{marginBottom:0},ease:Expo.easeOut})},function(){TweenMax.to($(this).find(".program-info h3"),.4,{css:{marginBottom:$trans},ease:Expo.easeOut})})}//////end function homePage
/** *******************************************************************************************
		 =MEDIA CENTER
*********************************************************************************************/
function mediaCenterPage(do_media_center){/*page functions*/
/*Animation Loop*/
function mediaCenter_Page_scroll(){_raf_scroll_id=_rAF_loop(mediaCenterPage_scroll_rAF)}function mediaCenterPage_scroll_rAF(){$(".scroll-helper").css("opacity",2-$_window.scrollTop()/100),didScroll=!$_body.hasClass("mobile")}if(!do_media_center)return $_window.off("scroll.mediaCenterPage"),!1;$_window.on("scroll.mediaCenterPage",mediaCenter_Page_scroll);/*variables*/
var $anchor=$(".anchor"),$loadMore=$(".section-container").find("button");/*events*/
$anchor.click(function(e){e.preventDefault();var href=$(this).attr("href");TweenMax.to(window,1,{scrollTo:href,ease:Circ.easeInOut})}),/*events*/
$loadMore.on("click",function(){var $this=$(this),term=$this.attr("data-term");$.get("/wp-json/mirpuri/v1/get-posts?term="+term+"&offset="+realOffset,function(data){$.each(data,function(key,value){if(total=value.total,key%2==0)var element_class="xxlarge-offset-2";else var element_class="";
// console.log(value);
// console.log(realOffset);
$this.closest("article").find(".news-wrapper").last().after('<div class="xxlarge-6 '+element_class+' news-wrapper"><a href="'+value.url+'"><div class="news-photo"><div class="block-bg-cover"><picture><source srcset="'+value.thumb_url+" 1x, "+value.thumb_retina_url+' 2x"><img class="element-cover" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" alt=""></picture></div></div></a><a href="'+value.url+'"><div class="news-info"><h3>'+value.term[0].name+"<span> — "+value.date+'</span></h3><h2 class="title">'+value.post_title+'</h2><p class="text">'+value.content+"...</p></div></a></div>")}),realOffset+=2,total<=$this.closest(".row").find(".news-wrapper").length&&$this.hide()})})}//////end function mediaCenter
/** *******************************************************************************************
		 =PROGRAMS
*********************************************************************************************/
function programsPage(do_programs){/*Animation Loop*/
function programsPage_scroll(){_raf_scroll_id=_rAF_loop(programsPage_scroll_rAF)}function programsPage_scroll_rAF(){var $maskN=$(".mask-number");globalStuff(),didScroll=!$_body.hasClass("mobile"),$maskN.each(function(){$div=$(this),verge.inViewport($div,-150)&&(TweenMax.to($(this).find("span"),2,{y:0,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".title"),2,{y:0,opacity:1,delay:.1,ease:Expo.easeOut}),TweenMax.to($(this).closest("article").find(".text"),2,{y:0,opacity:1,delay:.3,ease:Expo.easeOut}))})}if(!do_programs)return $_window.off("scroll.programsPage"),!1;$_window.on("scroll.programsPage",programsPage_scroll);/*variables*/
var $video=$("#video-wrapper").find("video")[0],$playVideo=$("#play-btn"),$videoWrapper=$("#video-wrapper"),bool=!1,boolProg=!1;if(
// console.log(boolProg);
/*events*/
TweenMax.to("#programs-list-container",1,{className:"+=show",delay:1}),$(".wrapper").click(function(){var id=$(this).attr("data-id");TweenMax.to(window,1,{scrollTo:"#"+id,ease:Circ.easeInOut}),$(".wrapper").removeClass("active"),$(".wrapper[data-id="+id+"]").addClass("active")}),$videoWrapper.click(function(){bool?($video.pause(),$playVideo.removeClass("off"),bool=!1):($video.play(),$playVideo.addClass("off"),bool=!0)}),$(".page-toload").hasClass("performing-arts"))var file="artes.json";else if($(".page-toload").hasClass("social-responsability"))var file="social.json";else if($(".page-toload").hasClass("marine-conservation"))var file="marine.json";else if($(".page-toload").hasClass("wildlife-conservation"))var file="wildlife.json";else if($(".page-toload").hasClass("medical-education-and-research"))var file="medical.json";else if($(".page-toload").hasClass("aeronautical-education-and-research"))var file="aero.json";var lineParams={container:document.getElementById("picto"),renderer:"svg",loop:!0,autoplay:!0,path:"/public/pictos/bodymovin/"+file};lineMorph=bodymovin.loadAnimation(lineParams),lineMorph.play(),/*page functions*/
$("#programs-list-container").html($(".programs-menu").html());var $programsListHeight=$("#programs-list-container").find("ul").height(),$programsList=$("#programs-list-container");TweenMax.set($programsList.find("ul"),{height:0}),$(document).on("click","#programs-list-container",function(){boolProg?($(this).find(".arrow").removeClass("open"),TweenMax.to($("#programs-list-container").find("ul"),.3,{height:0,ease:Power2.easeOut}),$("#programs-list-container").find("ul li").removeClass("open"),boolProg=!1):($(this).find(".arrow").addClass("open"),TweenMax.to($("#programs-list-container").find("ul"),.5,{height:$programsListHeight,ease:Power2.easeOut}),$("#programs-list-container").find("ul li").addClass("open"),boolProg=!0)}),$(".mask-program").click(function(){$("#programs-list-container").find(".arrow").removeClass("open"),TweenMax.to($("#programs-list-container").find("ul"),.3,{height:0,ease:Power2.easeOut}),$("#programs-list-container").find("ul li").removeClass("open"),boolProg=!1});var $elem=$(".active-program").find("h2"),$trans=0;$elem.each(function(){var $this=$(this),$h=$this.height(),words=$.trim($this.text()).split(" ");words.length>6&&$h>60?TweenMax.to($this,.4,{y:$h/3,force3D:!0,ease:Expo.easeOut}):TweenMax.to($this,.4,{y:0,force3D:!0,ease:Expo.easeOut}),words.length>6&&120==$h&&TweenMax.to($this,.4,{y:60,force3D:!0,ease:Expo.easeOut}),words.length>6&&150==$h&&TweenMax.to($this,.4,{y:90,force3D:!0,ease:Expo.easeOut}),words.length>6&&180==$h&&TweenMax.to($this,.4,{y:120,force3D:!0,ease:Expo.easeOut}),words.length>6&&210==$h&&TweenMax.to($this,.4,{y:150,force3D:!0,ease:Expo.easeOut}),words.length>6&&240==$h&&TweenMax.to($this,.4,{y:180,force3D:!0,ease:Expo.easeOut}),words.length>6&&270==$h&&TweenMax.to($this,.4,{y:210,force3D:!0,ease:Expo.easeOut}),words.length>6&&300==$h&&TweenMax.to($this,.4,{y:240,force3D:!0,ease:Expo.easeOut}),$_body.hasClass("mobile")&&TweenMax.to($this,.4,{y:0,force3D:!0,ease:Expo.easeOut})}),$_body.hasClass("mobile")||$(".active-program").hover(function(){$trans=$(this).find("h2").css("transform"),TweenMax.to($(this).find("h2"),.4,{y:0,force3D:!0,ease:Expo.easeOut})},function(){TweenMax.to($(this).find("h2"),.4,{css:{transform:$trans},ease:Expo.easeOut})}),$.doTimeout(800,function(){$(function(){
// Find all YouTube videos
var $allVideos=$("iframe"),
// The element that is fluid width
$fluidEl=$(".programs-video-container");
// Figure out and save aspect ratio for each video
$allVideos.each(function(){$(this).data("aspectRatio",this.height/this.width).removeAttr("height").removeAttr("width")}),
// When the window is resized
// (You'll probably want to debounce this)
$(window).resize(function(){var newWidth=$fluidEl.width();
// Resize all videos according to their own aspect ratio
$allVideos.each(function(){var $el=$(this);$el.width(newWidth).height(newWidth*$el.data("aspectRatio"))})}).resize()})})}//////end function programs
/** *******************************************************************************************
		 =MEDIA CENTER
*********************************************************************************************/
function singleMediaCenterPage(do_single_media_center){/*Animation Loop*/
function singleMediaCenter_Page_scroll(){_raf_scroll_id=_rAF_loop(singleMediaCenterPage_scroll_rAF)}function singleMediaCenterPage_scroll_rAF(){$(".scroll-helper").css("opacity",2-$_window.scrollTop()/100),didScroll=!$_body.hasClass("mobile")}if(!do_single_media_center)return $_window.off("scroll.singleMediaCenterPage"),!1;$_window.on("scroll.singleMediaCenterPage",singleMediaCenter_Page_scroll)}//////end function mediaCenter
/** *******************************************************************************************
		 =SINGLE NOTICIAS
*********************************************************************************************/
function singleNoticiasPage(do_single_noticias){/*Animation Loop*/
function singleNoticias_Page_scroll(){_raf_scroll_id=_rAF_loop(singleNoticiasPage_scroll_rAF)}function singleNoticiasPage_scroll_rAF(){$(".scroll-helper").css("opacity",2-$_window.scrollTop()/100),didScroll=!$_body.hasClass("mobile")}if(!do_single_noticias)return $_window.off("scroll.singleNoticiasPage"),!1;$_window.on("scroll.singleNoticiasPage",singleNoticias_Page_scroll),$(".slider-pictures-wrapper").imagesLoaded(function(){$(".slider-pictures-wrapper").slick({dots:!0,adaptiveHeight:!0,autoplay:!0,swipeToSlide:!0})});var numberSlides=$(".slide-active").length,$btnRight=$(".slider-arrow.right"),$btnLeft=$(".slider-arrow.left"),$activeSlide=$(".slide-active.active").attr("data-id"),carouselActive=new TimelineMax,moveOn=!0;$.each($(".slide-active"),function(){var id=$(this).attr("data-id");$("#bullets-active-carousel").append('<button class="bullet" data-id="'+id+'"></button>')}),$("#bullets-active-carousel").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),$trigger=function(){return right=function(){$slideActive=$(".slide-active.active"),$slideNext=$(".slide-active.next"),$activeSlide=$slideNext.attr("data-id"),carouselActive.to($slideActive,1,{css:{left:"100%"},ease:Expo.easeInOut,force3D:!0,onComplete:function(){$slideNext.removeClass("next").addClass("active"),$slideNext.next(".slide-active").addClass("next"),$slideActive.removeClass("active").css("left","0"),$slideNext.next().is(".slide-active")?$slideNext.next(".slide-active").addClass("next"):$(".slide-active").first().addClass("next"),$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$("#bullets-active-carousel").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),moveOn=!0}})},left=function(){$slideActive=$(".slide-active.active"),$slideNext=$(".slide-active.next"),$activeSlide=$slideActive.attr("data-id"),numberSlides>2&&$slideNext.css("display","none"),carouselActive.to($slideActive,1,{css:{left:"-100%"},ease:Expo.easeInOut,force3D:!0,onComplete:function(){$slideNext.removeClass("next"),$slideActive.removeClass("active").addClass("next").css("left","0"),$(".slide-active").css("display","block"),$slideActive.prev().is(".slide-active")?$slideActive.prev(".slide-active").addClass("active"):$(".slide-active").last().addClass("active"),numberSlides>2?0==$activeSlide?$activeSlide=2:$activeSlide-=1:0==$activeSlide?$activeSlide=1:$activeSlide-=1,$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$("#bullets-active-carousel").find(".bullet[data-id="+$activeSlide+"]").addClass("selected"),moveOn=!0}})},{right:right,left:left}}(),$(".bullet").on("click",function(){$(".bullet").css("pointer-events","none");var idClick=$(this).attr("data-id"),num=parseInt(idClick),total=num+1,idActive=$(".slide-active.active").attr("data-id");$activeSlide=$(".slide-active.next").attr("data-id"),idClick>idActive?($(".slide-active").removeClass("active").removeClass("next"),$(".slide-active[data-id="+idClick+"]").addClass("active"),total==numberSlides?$(".slide-active").first().addClass("next"):$(".slide-active[data-id="+idClick+"]").next(".slide-active").addClass("next"),$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$(".bullet").css("pointer-events","auto"),$("#bullets-active-carousel").find(".bullet[data-id="+num+"]").addClass("selected").css("pointer-events","none")):($(".slide-active").removeClass("active").removeClass("next"),$(".slide-active[data-id="+idClick+"]").addClass("active"),total==numberSlides?$(".slide-active").last().addClass("next"):$(".slide-active[data-id="+idClick+"]").next(".slide-active").addClass("next"),$("#bullets-active-carousel").find(".bullet").removeClass("selected"),$(".bullet").css("pointer-events","auto"),$("#bullets-active-carousel").find(".bullet[data-id="+num+"]").addClass("selected").css("pointer-events","none"))}),$btnRight.on("click",function(){moveOn&&($trigger.right(),moveOn=!1)}),$btnLeft.on("click",function(){moveOn&&($trigger.left(),moveOn=!1)}),$(function(){
// Find all YouTube videos
var $allVideos=$("iframe"),
// The element that is fluid width
$fluidEl=$(".news-text.full");
// Figure out and save aspect ratio for each video
$allVideos.each(function(){$(this).data("aspectRatio",this.height/this.width).removeAttr("height").removeAttr("width")}),
// When the window is resized
// (You'll probably want to debounce this)
$(window).resize(function(){var newWidth=$fluidEl.width();
// Resize all videos according to their own aspect ratio
$allVideos.each(function(){var $el=$(this);$el.width(newWidth).height(newWidth*$el.data("aspectRatio"))})}).resize()})}$(document).ready(function(){
//** outdatedbrowser.com
// Must be the first to be call or in older browsers IE6,7 will have weird js erros on my code, and the plugin will not work
outdatedBrowser({bgColor:"#f25648",color:"#fff",lowerThan:"transform",languagePath:""}),
//** MODERNIZR not supporter properties
Modernizr.addTest("backgroundcliptext",function(){var div=document.createElement("div");return div.style.cssText=Modernizr._prefixes.join("background-clip:text;"),!!div.style.cssText.replace(/\s/g,"").length}),Modernizr.addTest("object-fit",!!Modernizr.prefixed("objectFit"))});//////end function main load content
var _customScroll=null,_page_scroll_listener=null;// end function
/*******************************************************************************************
 ****                                                                                   ****
    =DOCUMENT =READY =START Document ready
 ****                                                                                   ****
*********************************************************************************************/
$(document).ready(function(){
//** =Global objects
$_window=$(window),$_body=$("body"),$_html=$("html"),$_mainPage=$(".page-main"),$_btn_nav_main=$(".btn-nav-main"),$_currentPage=$(".page-main.page-current"),$_toPreload=$(".preload"),$_loadingPage=$("#loading-page"),
//** =Global variables
calculateGlobalValues(),_global_allowNavigate=!1,//When loading do not allow clicks by user ( onStartPage revers to true)
_server_hostname=window.location.hostname,
// Request Animation Frame
_rAF_loop=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||
// IE Fallback, you can even fallback to onscroll
function(callback){window.setTimeout(callback,1e3/60)},_raf_loop_id=null,_raf_scroll_id=null,
//** =START PAGES
onStartPageWhenRefresh(!0),mainNavigation(),
// VW/VH Unis fix for IOS
window.viewportUnitsBuggyfill.init(),
//Start Plugins
FastClick.attach(document.body);//no 300ms tap delay!
/** -----------------------------------------------------------------------------------------
  =LOAD SECTIONS - triger events =CLICK to LOAD PAGE
  body class="js-no-ajax ismobile" > inserida via php == no nosso caso a mobile
  --------------------------------------------------------------------------------------------*/
var domainSite=window.location.host,homeTitle=$("a").attr("data-title-home");_forPopstate=!0,$_linkInternal=$('a[href*="'+domainSite+'"]'),$(document).on("click",'a[data-remote="true"]',function(){var $this=$(this);
// **ALLOW user load other pages only after page is loaded ( onStartPage )
if(!_global_allowNavigate)return!1;
// exit and have normal click
// if ( $_html.hasClass('mobile') )  return true;
if(_global_allowNavigate=!1,!$this.hasClass("modal")&&!$this.hasClass("js-no-transPage")){
//
var thisHref=$this.attr("href"),thisTitle=$this.attr("data-title"),newContent=thisHref,forHistory=newContent,pageTransition=$this.attr("data-pageTrans"),forTitle=thisTitle+" | Mirpuri Foundation";
//home page
//for history
// for title
//ga('send', 'pageview', window.location.pathname); //analytics
return thisTitle||(forTitle=homeTitle),pageTransition||(pageTransition="default"),_forPopstate&&history.pushState({},forTitle,forHistory),_forPopstate=!0,$("head title").html(forTitle),loadPages(newContent,pageTransition),!1}}),//end click
/// HISTORY
//  note: Chrome and Safari will fire a popstate event when the page loads but Firefox doesnt. When your page loads, it might have a non-null state object and the page will receive an onload event, but no popstate event. (window.history.state; on refresh page)
window.addEventListener&&window.addEventListener("popstate",function(e){// firefox vs webkit and safari trigers on
return!$_html.hasClass("mobile")&&(e.state?(_forPopstate=!1,window.location=window.location,!1):(_forPopstate=!0,!1))}),//endif: does not excute for <= IE8
/* -------------------------------------------------------------------------------------------
    =EVENTS DEFAULT BURO
    -------------------------------------------------------------------------------------------- */
//OPEN NEW WINDOW
$(document).on("click","a[rel=external]",function(event){return event.stopImmediatePropagation(),event.preventDefault(),event.stopPropagation(),window.open($(this).attr("href")).closed}),
//PRINT
$("a[rel=print]").click(function(){window.print();return!1}),
//E-MAIL: has classclass="email", e [-at-]
$("a.email").each(function(){var mailReal=$(this).text().replace("[-at-]","@");$(this).text(mailReal),$(this).attr("href","mailto:"+mailReal)}),
//CLEAR FORMS
$("input[type=text], input[type=email], input.text, input.email, textarea").each(function(){if($(this).hasClass("txtClear")){var defeito=this.defaultValue;$(this).focus(function(){$(this).val()==defeito&&$(this).val("")}),$(this).blur(function(){""==$(this).val()&&$(this).val(defeito)})}}),
//OPEN POPUP
$(document).on("click",".newWindow",function(){event.stopImmediatePropagation(),event.preventDefault(),event.stopPropagation();var newwindow=window.open($(this).attr("href"),"","height=480,width=560");return window.focus&&newwindow.focus(),!1}),/*-------------------------------------------------------------------------------------------
    =KEYS
    --------------------------------------------------------------------------------------------*/
$(document).on("keydown",function(event){switch(event.which){case 40:case 38:case 39:case 37://prev
// return false;
break;case 27://close (esc)
$("#btn-menu").click()}}),//end keypress
/*-------------------------------------------------------------------------------------------
    =RESIZE on
    --------------------------------------------------------------------------------------------*/
$_window.on("resize",$.debounce(500,function(){if(
//** =recalculate global variables
calculateGlobalValues(),$_html.hasClass("no-object-fit")){var $element=$(".page-current .element-cover");resizeLikeCover($element)}var $elem=($(".program-info h3").outerHeight(),$("#programs-wrapper").css("top"),$(".program-info h3"));$_body.hasClass("mobile")||$elem.each(function(){var $this=$(this),$h=$this.height();44==$h&&TweenMax.to($this,.4,{css:{marginBottom:-66},ease:Expo.easeOut}),66==$h&&TweenMax.to($this,.4,{css:{marginBottom:-88},ease:Expo.easeOut}),88==$h&&TweenMax.to($this,.4,{css:{marginBottom:-110},ease:Expo.easeOut}),110==$h&&TweenMax.to($this,.4,{css:{marginBottom:-137},ease:Expo.easeOut}),132==$h&&TweenMax.to($this,.4,{css:{marginBottom:-158},ease:Expo.easeOut}),154==$h&&TweenMax.to($this,.4,{css:{marginBottom:-178},ease:Expo.easeOut}),$_body.hasClass("mobile")&&TweenMax.to($this,.4,{css:{marginBottom:0},ease:Expo.easeOut})});var maskH=$(".header-container .mask").outerHeight(!0),paddUl=$(".header-container ul").outerHeight(!0),lineH=$(".header-container .line").outerHeight(!0),maskS=$(".header-container .mask-subject").outerHeight(!0),totalOne=maskH+paddUl,totalTwo=maskH+lineH;($_body.hasClass("media-center")||$_body.hasClass("archive-noticias"))&&TweenMax.to(".header-container",.2,{height:totalOne+"px"}),$_body.hasClass("four04")&&TweenMax.to(".header-container",.2,{height:520}),$_body.hasClass("four04")&&_globalViewportW>1024&&TweenMax.to(".header-container",.2,{height:570}),($_body.hasClass("single-noticias")||$_body.hasClass("active-programas"))&&TweenMax.to(".header-container",.2,{height:totalTwo+"px"}),$_body.hasClass("media-center")||$_body.hasClass("archive-noticias")||$_body.hasClass("single-noticias")||$_body.hasClass("active-programas")||$_body.hasClass("four04")||TweenMax.to(".header-container",.2,{height:maskH+"px"}),($_body.hasClass("media-center")&&_globalViewportW<414||$_body.hasClass("archive-noticias")&&_globalViewportW<414)&&TweenMax.to(".header-container",.2,{height:paddUl+maskH+lineH+"px"}),($_body.hasClass("active-programas")&&_globalViewportW<414||$_body.hasClass("single-noticias")&&_globalViewportW<414)&&TweenMax.to(".header-container",.2,{height:maskS+maskH+lineH+"px"}),$_body.hasClass("media-center")||$_body.hasClass("archive-noticias")||$_body.hasClass("single-noticias")||$_body.hasClass("active-programas")||$_body.hasClass("four04")||!(_globalViewportW<414)||TweenMax.to(".header-container",.2,{height:totalTwo+"px"}),$_body.hasClass("mobile")||$.doTimeout("scrollStuff",250,function(){return flag=!0,!(!didScroll||1!=flag)&&(hasScrolled(),didScroll=!1,!0)}),$activeTitle=$(".active-program").find("h2"),$activeTitle.each(function(){var $this=$(this),$h=$this.height(),words=$.trim($this.text()).split(" ");words.length>6&&$h>60?TweenMax.to($this,.4,{y:$h/3,force3D:!0,ease:Expo.easeOut}):TweenMax.to($this,.4,{y:0,force3D:!0,ease:Expo.easeOut}),words.length>6&&120==$h&&TweenMax.to($this,.4,{y:60,force3D:!0,ease:Expo.easeOut}),words.length>6&&150==$h&&TweenMax.to($this,.4,{y:90,force3D:!0,ease:Expo.easeOut}),words.length>6&&180==$h&&TweenMax.to($this,.4,{y:120,force3D:!0,ease:Expo.easeOut}),words.length>6&&210==$h&&TweenMax.to($this,.4,{y:150,force3D:!0,ease:Expo.easeOut}),words.length>6&&240==$h&&TweenMax.to($this,.4,{y:180,force3D:!0,ease:Expo.easeOut}),words.length>6&&270==$h&&TweenMax.to($this,.4,{y:210,force3D:!0,ease:Expo.easeOut}),words.length>6&&300==$h&&TweenMax.to($this,.4,{y:240,force3D:!0,ease:Expo.easeOut}),$_body.hasClass("mobile")&&TweenMax.to($this,.4,{y:0,force3D:!0,ease:Expo.easeOut})})}))});
//GLOBAL FUNCTIONS
var bool=!1,lastScrollTop=0,didScroll=!0,flagSub=!0,btnTop=$("#programs-wrapper").css("top");onYouTubePlayerReady=function(player1){console.log("play"),callPlayer($("#header-iframe"),"playVideo")},setInterval(function(){didScroll&&(hasScrolled(),didScroll=!1)},250),
//GLOBAL EVENTS
$("#btn-menu").click(function(){if(!bool)return $(this).addClass("openMenu"),openMenu(),boolProg=!1;$(this).removeClass("openMenu"),closeMenu(),($("html").hasClass("ie")||$("html").hasClass("edge"))&&$("#nav-main").css("overflow-y","hidden")}),$(".main-logo").click(function(){$(".mask-sub-link a").removeClass("active"),$("#btn-menu").hasClass("openMenu")&&($("#btn-menu").removeClass("openMenu"),closeMenu(),($("html").hasClass("ie")||$("html").hasClass("edge"))&&$("#nav-main").css("overflow-y","hidden"))}),$(".mask-nav-item:not(.programs-btn)").click(function(){$(".mask-sub-link a").removeClass("active"),$("#btn-menu").removeClass("openMenu"),closeMenu(),($("html").hasClass("ie")||$("html").hasClass("edge"))&&$("#nav-main").css("overflow-y","hidden")}),$("#programs-link").click(function(e){var $maskSubItem=$(".mask-sub-link");e.preventDefault(),flagSub?($("#sub-menu").slideToggle(),TweenMax.staggerTo($maskSubItem,.8,{css:{transform:"translateY(0)"},ease:Power2.easeOut},.1),flagSub=!1,$("#sub-menu").addClass("open")):(TweenMax.to($maskSubItem,1,{y:"100%",ease:Expo.easeOut},"-=1"),$("#sub-menu").slideToggle(),flagSub=!0,$("#sub-menu").removeClass("open"))}),$(".mask-sub-link").click(function(){$(".mask-sub-link a").removeClass("active"),$(this).find("a").addClass("active"),$("#btn-menu").removeClass("openMenu"),closeMenu(),($("html").hasClass("ie")||$("html").hasClass("edge"))&&$("#nav-main").css("overflow-y","hidden")}),$(document).keyup(function(e){27===e.keyCode&&bool&&(closeMenu(),$("#btn-menu").removeClass("openMenu"),($("html").hasClass("ie")||$("html").hasClass("edge"))&&$("#nav-main").css("overflow-y","hidden"))}),$(document).keyup(function(e){if(32===e.keyCode)return!1}),$(document).keyup(function(e){if(13===e.keyCode)return!1});